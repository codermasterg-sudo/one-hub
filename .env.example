# One Hub 生产环境配置示例
# 生成时间: 2025年11月23日
# ⚠️ 警告: USER_TOKEN_SECRET 一旦设置不可修改！

# ============================================
# Docker 镜像配置
# ============================================
# 镜像名称（默认使用本地构建的镜像）
IMAGE_NAME=one-hub
# 镜像标签（默认使用 latest）
IMAGE_TAG=latest

# ============================================
# 基础配置
# ============================================
TZ=Asia/Shanghai
GIN_MODE=release
LOG_LEVEL=info
PORT=8001

# ============================================
# 安全配置（请勿泄露）
# ============================================
# 会话密钥（32位随机字符串，系统重启后已登录用户cookie仍有效）
# 生成方式: openssl rand -hex 32
SESSION_SECRET=your_random_32_char_session_secret_here

# 用户令牌密钥（32位以上随机字符串，设置后请勿修改，否则会导致用户令牌失效）
# 生成方式: openssl rand -hex 32
USER_TOKEN_SECRET=your_random_32_char_user_token_secret_here

# HashIDs 盐值（必须为唯一字符组成的字符串）
# 生成方式: cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 1
HASHIDS_SALT=your_unique_hashids_salt_here

# ============================================
# 数据库配置
# ============================================
# MySQL root 密码
# 生成方式: openssl rand -hex 32
MYSQL_ROOT_PASSWORD=your_mysql_root_password_here

# MySQL 用户名
MYSQL_USER=oneapi

# MySQL 用户密码
# 生成方式: openssl rand -hex 32
MYSQL_PASSWORD=your_mysql_user_password_here

# MySQL 数据库名
MYSQL_DATABASE=one-api

# 数据库连接字符串（MySQL）
# 格式: 用户名:密码@tcp(主机:端口)/数据库名
SQL_DSN=oneapi:your_mysql_user_password_here@tcp(db:3306)/one-api
# 如使用本地MySQL可改为: SQL_DSN=root:your_password@tcp(localhost:3306)/one-api

# ============================================
# Redis 配置（可选）
# ============================================
# Redis连接字符串（如不使用Redis可注释此行）
REDIS_CONN_STRING=redis://redis:6379
# Redis数据库编号
REDIS_DB=0

# ============================================
# 性能优化配置
# ============================================
# 启用内存缓存（会导致用户额度更新有延迟）
MEMORY_CACHE_ENABLED=true
# 缓存同步频率（秒）
SYNC_FREQUENCY=300
# 启用批量更新（会导致用户额度更新有延迟，可解决数据库连接数过多问题）
BATCH_UPDATE_ENABLED=true
# 批量更新时间间隔（秒）
BATCH_UPDATE_INTERVAL=5

# ============================================
# 限流配置
# ============================================
# 全局 API 速率限制（单IP三分钟内最大请求数）
GLOBAL_API_RATE_LIMIT=180
# 全局 Web 速率限制（单IP三分钟内最大请求数）
GLOBAL_WEB_RATE_LIMIT=100
# 中继请求超时时间（秒）
RELAY_TIMEOUT=120

# ============================================
# 渠道管理配置
# ============================================
# 渠道测试频率（分钟，0表示不测试）
CHANNEL_TEST_FREQUENCY=60
# 批量更新/测试渠道时的请求间隔（秒）
POLLING_INTERVAL=2

# ============================================
# 价格管理配置
# ============================================
# 自动更新价格
AUTO_PRICE_UPDATES=true
# 价格更新模式：system=使用程序内置价格表，add=仅增加，overwrite=覆盖，update=仅更新现有
AUTO_PRICE_UPDATES_MODE=system
# 价格更新服务地址
UPDATE_PRICE_SERVICE=https://raw.githubusercontent.com/Oaklight/onehub_prices/prices/oneapi_prices.json

# ============================================
# Clash 代理配置
# ============================================
# 说明：Clash 订阅 URL 直接在 clash/config.yaml 中配置（type: http）
# 以下配置仅作为参考，未被实际使用

# Clash HTTP代理端口（容器内端口）
CLASH_HTTP_PORT=7890
# Clash SOCKS代理端口（容器内端口）
CLASH_SOCKS_PORT=7891
# Clash API端口（用于 Dashboard 和监控）
CLASH_API_PORT=9090

# ============================================
# CLIProxy 配置
# ============================================
# CLIProxy 端口
CLIPROXY_PORT=8080
# CLIProxy 日志级别
CLIPROXY_LOG_LEVEL=info
