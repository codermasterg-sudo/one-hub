# One Hub 生产环境配置
# 生成时间: 2025年11月23日
# ⚠️ 警告: USER_TOKEN_SECRET 一旦设置不可修改！

# ============================================
# Docker 镜像配置
# ============================================
# 镜像名称（默认使用本地构建的镜像）
IMAGE_NAME=one-hub
# 镜像标签（默认使用 latest）
IMAGE_TAG=latest

# ============================================
# 基础配置
# ============================================
TZ=Asia/Shanghai
GIN_MODE=release
LOG_LEVEL=info
PORT=8001

# ============================================
# 安全配置（请勿泄露）
# ============================================
# 会话密钥（32位随机字符串，系统重启后已登录用户cookie仍有效）
SESSION_SECRET=b80738a1bbfbd45a6e7dfa04b7e7ac9c5355a4c358204bb6ad94985c7f13141
# 用户令牌密钥（32位以上随机字符串，设置后请勿修改，否则会导致用户令牌失效）
USER_TOKEN_SECRET=b6740eefcbc27e5462fce743e78dab5f5a2e993b161218d41c1d7097b22f35ca
# HashIDs 盐值（必须为唯一字符组成的字符串）
HASHIDS_SALT=oC6kBMuNTGXJOhals0IKV18DgdRL7y3j

# ============================================
# 数据库配置
# ============================================
# MySQL root 密码
MYSQL_ROOT_PASSWORD=2da063ddcb11c58bcabfb9db2a42e0dc55a7ea383b29eee4962eaa9d5b9a61e4
# MySQL 用户名
MYSQL_USER=oneapi
# MySQL 用户密码
MYSQL_PASSWORD=53b11d8f5b479b7014a044e86055914acbbf2176cd51c6c9c595b481e814af7c
# MySQL 数据库名
MYSQL_DATABASE=one-api
# 数据库连接字符串（MySQL）
SQL_DSN=oneapi:53b11d8f5b479b7014a044e86055914acbbf2176cd51c6c9c595b481e814af7c@tcp(db:3306)/one-api
# 如使用本地MySQL可改为: SQL_DSN=root:PZHosjztZjb2HovivQZJ53NfpryaxZeyLcYzs91+YTA=@tcp(localhost:3306)/one-api

# ============================================
# Redis 配置（可选）
# ============================================
# Redis连接字符串（如不使用Redis可注释此行）
REDIS_CONN_STRING=redis://redis:6379
# Redis数据库编号
REDIS_DB=0

# ============================================
# 性能优化配置
# ============================================
# 启用内存缓存（会导致用户额度更新有延迟）
MEMORY_CACHE_ENABLED=true
# 缓存同步频率（秒）
SYNC_FREQUENCY=300
# 启用批量更新（会导致用户额度更新有延迟，可解决数据库连接数过多问题）
BATCH_UPDATE_ENABLED=true
# 批量更新时间间隔（秒）
BATCH_UPDATE_INTERVAL=5

# ============================================
# 限流配置
# ============================================
# 全局 API 速率限制（单IP三分钟内最大请求数）
GLOBAL_API_RATE_LIMIT=180
# 全局 Web 速率限制（单IP三分钟内最大请求数）
GLOBAL_WEB_RATE_LIMIT=100
# 中继请求超时时间（秒）
RELAY_TIMEOUT=120

# ============================================
# 渠道管理配置
# ============================================
# 渠道测试频率（分钟，0表示不测试）
CHANNEL_TEST_FREQUENCY=60
# 批量更新/测试渠道时的请求间隔（秒）
POLLING_INTERVAL=2

# ============================================
# 价格管理配置
# ============================================
# 自动更新价格
AUTO_PRICE_UPDATES=true
# 价格更新模式：system=使用程序内置价格表，add=仅增加，overwrite=覆盖，update=仅更新现有
AUTO_PRICE_UPDATES_MODE=system
# 价格更新服务地址
UPDATE_PRICE_SERVICE=https://raw.githubusercontent.com/Oaklight/onehub_prices/prices/oneapi_prices.json

# ============================================
# Clash 代理配置
# ============================================
# 说明：Clash 订阅 URL 直接在 clash/config.yaml 中配置（type: http）
# 以下配置仅作为参考，未被实际使用

# Clash HTTP代理端口（容器内端口）
CLASH_HTTP_PORT=7890
# Clash SOCKS代理端口（容器内端口）
CLASH_SOCKS_PORT=7891
# Clash API端口（用于 Dashboard 和监控）
CLASH_API_PORT=9090

# ============================================
# CLIProxy 配置
# ============================================
# CLIProxy 端口
CLIPROXY_PORT=8080
# CLIProxy 日志级别
CLIPROXY_LOG_LEVEL=info
